# ============================================
# OpticsERP Configuration Template
# ============================================
# Copy this file to .env and customize values
# DO NOT commit .env to git (it's in .gitignore)
#
# Last Updated: 2025-11-30
# Version: 1.0.0
# ============================================

# ============================================
# PostgreSQL Database Configuration
# ============================================
# Database connection settings for Odoo
POSTGRES_DB=opticserp
POSTGRES_USER=odoo
POSTGRES_PASSWORD=ChangeMeInProduction!
POSTGRES_HOST=postgres
POSTGRES_PORT=5432

# PostgreSQL tuning (production)
# POSTGRES_MAX_CONNECTIONS=200
# POSTGRES_SHARED_BUFFERS=2GB
# POSTGRES_EFFECTIVE_CACHE_SIZE=6GB

# ============================================
# Odoo Configuration
# ============================================
ODOO_VERSION=17.0
ODOO_ADMIN_PASSWORD=AdminPasswordHere!

# Database filter (regex to match allowed databases)
ODOO_DB_FILTER=opticserp

# Worker configuration (production)
# ODOO_WORKERS=4
# ODOO_MAX_CRON_THREADS=2
# ODOO_LIMIT_MEMORY_SOFT=2147483648
# ODOO_LIMIT_MEMORY_HARD=2684354560

# Logging
# ODOO_LOG_LEVEL=info
# ODOO_LOG_HANDLER=:INFO

# ============================================
# KKT Adapter Configuration
# ============================================
# FastAPI server settings
KKT_ADAPTER_HOST=0.0.0.0
KKT_ADAPTER_PORT=8000

# ОФД (Operator of Fiscal Data) API
# Replace with your actual OFD provider URL and token
KKT_OFD_API_URL=https://ofd.example.ru/api/v1
KKT_OFD_API_TOKEN=YourOFDTokenHere

# SQLite buffer settings
KKT_BUFFER_MAX_SIZE=1000
KKT_BUFFER_PATH=/app/data/buffer.db

# Circuit Breaker settings
KKT_CIRCUIT_BREAKER_THRESHOLD=5
KKT_CIRCUIT_BREAKER_TIMEOUT=60
KKT_CIRCUIT_BREAKER_RECOVERY_TIMEOUT=300

# Hybrid Logical Clock settings
KKT_HLC_SYNC_INTERVAL=30

# Heartbeat to Odoo
KKT_HEARTBEAT_INTERVAL=30
KKT_HEARTBEAT_TIMEOUT=10

# ============================================
# Redis Configuration
# ============================================
# Redis for Celery message broker and cache
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=

# Redis persistence (production)
# REDIS_SAVE="900 1 300 10 60 10000"
# REDIS_APPENDONLY=yes

# ============================================
# Celery Configuration
# ============================================
# Celery for async tasks and background jobs
CELERY_BROKER_URL=redis://redis:6379/0
CELERY_RESULT_BACKEND=redis://redis:6379/0

# Celery worker configuration
# CELERY_WORKERS=4
# CELERY_MAX_TASKS_PER_CHILD=100

# ============================================
# Monitoring (Optional)
# ============================================
# Prometheus metrics
PROMETHEUS_ENABLED=false
PROMETHEUS_PORT=9090

# Grafana dashboards
GRAFANA_PORT=3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin

# Celery Flower (monitoring)
FLOWER_PORT=5555
FLOWER_BASIC_AUTH=admin:admin

# Jaeger tracing (optional)
# JAEGER_ENABLED=false
# JAEGER_PORT=16686

# ============================================
# Backup Configuration
# ============================================
# Backup retention and storage
BACKUP_RETENTION_DAYS=90
BACKUP_PATH=/opt/opticserp/backups

# Backup schedule (cron format)
# BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM

# ============================================
# Network Configuration
# ============================================
# Ports exposed to host
ODOO_PORT=8069
KKT_ADAPTER_PORT=8000

# Timezone
TZ=Europe/Moscow

# ============================================
# Security Settings
# ============================================
# SSL/TLS (production)
# SSL_ENABLED=false
# SSL_CERT_PATH=/etc/ssl/certs/opticserp.crt
# SSL_KEY_PATH=/etc/ssl/private/opticserp.key

# Nginx reverse proxy (production)
# NGINX_ENABLED=false
# NGINX_PORT=80
# NGINX_SSL_PORT=443

# ============================================
# Development Settings (DEV ONLY)
# ============================================
# Enable debug mode (DO NOT use in production!)
# ODOO_DEBUG_MODE=0
# KKT_DEBUG=0

# Auto-reload on code changes (DEV ONLY)
# ODOO_DEV_MODE=0
# KKT_RELOAD=0

# ============================================
# JIRA Integration (Optional)
# ============================================
# For automated ticket creation and tracking
# JIRA_URL=https://bozzyk44.atlassian.net
# JIRA_EMAIL=your-email@example.com
# JIRA_API_TOKEN=your-jira-api-token
# JIRA_PROJECT_KEY=OPTERP

# ============================================
# Notes
# ============================================
# - DO NOT use default passwords in production!
# - Generate strong passwords: openssl rand -base64 32
# - Keep this file secure (chmod 600 .env)
# - Backup .env file regularly
# - Update passwords every 90 days (production)
#
# For more information, see:
# - docs/installation/03_configuration.md
# - docs/installation/appendix_b_env_vars.md
